â€”-Clean customer orders
SELECT order_id, customer_id, pizza_id,
CASE WHEN exclusions = '' OR exclusions = 'null' THEN NULL ELSE exclusions END AS exclusions_cleaned,
CASE WHEN extras = '' OR extras = 'null' THEN NULL ELSE extras END AS extras_cleaned,
order_time
INTO customer_orders_cleaned
FROM customer_orders

-- Clean runner orders
SELECT order_id, runner_id,
CASE WHEN pickup_time = 'null' THEN NULL ELSE pickup_time END AS pickup_time_cleaned,
CASE
WHEN distance = 'null' THEN NULL
WHEN distance LIKE '%km' THEN TRIM('km' FROM distance)
ELSE distance
END AS distance_cleaned,
CASE
WHEN duration = 'null' THEN NULL
WHEN duration LIKE '%mins' THEN TRIM('mins' FROM duration)
WHEN duration LIKE '%minute' THEN TRIM('minute' FROM duration)
WHEN duration LIKE '%minutes' THEN TRIM('minutes' FROM duration)
ELSE duration
END AS duration_cleaned,
CASE
WHEN cancellation IS NULL OR cancellation = 'null' THEN NULL
ELSE cancellation
END AS cancellation_cleaned
INTO runner_orders_cleaned
FROM runner_orders;

-- Change column types
ALTER TABLE runner_orders_cleaned
ALTER COLUMN pickup_time_cleaned TYPE TIMESTAMP USING pickup_time_cleaned::timestamp,
ALTER COLUMN distance_cleaned TYPE FLOAT USING distance_cleaned::float,
ALTER COLUMN duration_cleaned TYPE INT USING duration_cleaned::int;
